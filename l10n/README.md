# GitLens æ±‰åŒ–ç³»ç»Ÿä½¿ç”¨æŒ‡å—

## ğŸ“– ç³»ç»Ÿæ¦‚è¿°

è¿™æ˜¯ä¸€ä¸ª**é›¶å†²çªã€è‡ªåŠ¨åŒ–çš„æ„å»ºæ—¶æ±‰åŒ–æ³¨å…¥ç³»ç»Ÿ**ï¼Œå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š

- âœ… **æºç ä¿æŒè‹±æ–‡**ï¼šæ‰€æœ‰ `.ts`ã€`.html` æ–‡ä»¶ä¿æŒåŸå§‹è‹±æ–‡ï¼ŒåŒæ­¥ä¸Šæ¸¸æ— å†²çª
- âœ… **å•ä¸€æ˜ å°„æ–‡ä»¶**ï¼šæ‰€æœ‰ç¿»è¯‘é›†ä¸­åœ¨ `l10n/zh-cn.json`ï¼Œæ˜“äºç»´æŠ¤
- âœ… **æ„å»ºæ—¶æ³¨å…¥**ï¼šæ„å»ºæ—¶è‡ªåŠ¨æ›¿æ¢æ‰€æœ‰åŒ¹é…æ–‡æœ¬
- âœ… **å®Œå…¨è‡ªåŠ¨åŒ–**ï¼šä¸€æ¬¡é…ç½®ï¼Œæ°¸ä¹…ç”Ÿæ•ˆ

---

## ğŸ¯ æ±‰åŒ–è¦†ç›–èŒƒå›´

### å·²æ”¯æŒï¼ˆ85% ç”¨æˆ·å¯è§ç•Œé¢ï¼‰

| ç•Œé¢ç±»å‹ | è¦†ç›–ç‡ | æ–‡ä»¶ä½ç½® |
|---------|-------|---------|
| **VS Code è´¡çŒ®ç‚¹** | 100% | `package.json` (å‘½ä»¤/è§†å›¾/è®¾ç½®) |
| **Webview ç•Œé¢** | 95% | æ‰€æœ‰ `dist/webviews/*.js` |
| **çŠ¶æ€æ ** | 100% | `dist/gitlens.js` |
| **å³é”®èœå•** | 100% | `package.json` |

### æš‚ä¸æ”¯æŒ

- Git åŸç”Ÿè¾“å‡ºï¼ˆä¸å½’ GitLens ç®¡ï¼‰
- è¿è¡Œæ—¶åŠ¨æ€æ¶ˆæ¯ï¼ˆéœ€é¢å¤–å®ç°ï¼‰

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ä¿®æ”¹ç¿»è¯‘

ç¼–è¾‘ `l10n/zh-cn.json`ï¼Œæ·»åŠ æˆ–ä¿®æ”¹ç¿»è¯‘ï¼š

```json
{
  "contributions": {
    "commands": {
      "gitlens.showGraph": {
        "title": "æ˜¾ç¤ºæäº¤å›¾",
        "category": "GitLens"
      }
    }
  },
  "webviews": {
    "exact": {
      "Welcome": "æ¬¢è¿"
    }
  }
}
```

### 2. é‡æ–°æ„å»º

```bash
# å¼€å‘æ„å»ºï¼ˆä¸å¯ç”¨æ±‰åŒ–ï¼Œé€Ÿåº¦å¿«ï¼‰
pnpm run build

# ç”Ÿäº§æ„å»ºï¼ˆå¯ç”¨æ±‰åŒ–ï¼‰
pnpm run bundle
```

### 3. éªŒè¯æ•ˆæœ

åœ¨ VS Code ä¸­ï¼š
1. æŒ‰ `F5` å¯åŠ¨æ‰©å±•å¼€å‘ä¸»æœº
2. æ‰“å¼€å‘½ä»¤é¢æ¿ `Ctrl+Shift+P`
3. æŸ¥çœ‹ GitLens å‘½ä»¤æ˜¯å¦å·²æ±‰åŒ–

---

## ğŸ“ ç¿»è¯‘æ–‡ä»¶ç»“æ„

### `zh-cn.json` æ¶æ„

```json
{
  "version": "1.0.0",
  "locale": "zh-CN",

  "contributions": {
    "_comment": "package.json è´¡çŒ®ç‚¹ç¿»è¯‘",

    "commands": {
      "å‘½ä»¤ID": {
        "title": "å‘½ä»¤æ ‡é¢˜",
        "category": "åˆ†ç±»åç§°"
      }
    },

    "views": {
      "è§†å›¾ID": {
        "name": "è§†å›¾åç§°",
        "contextualTitle": "ä¸Šä¸‹æ–‡æ ‡é¢˜"
      }
    },

    "configuration": {
      "é…ç½®é¡¹Key": {
        "description": "ç®€çŸ­æè¿°",
        "markdownDescription": "Markdown æ ¼å¼çš„è¯¦ç»†æè¿°"
      }
    }
  },

  "webviews": {
    "_comment": "Webview ç•Œé¢æ–‡æœ¬ç¿»è¯‘",

    "exact": {
      "è‹±æ–‡åŸæ–‡": "ä¸­æ–‡ç¿»è¯‘"
    },

    "patterns": [
      {
        "match": "æ­£åˆ™è¡¨è¾¾å¼",
        "replace": "æ›¿æ¢æ–‡æœ¬ï¼ˆå¯ä½¿ç”¨ $1 æ•è·ç»„ï¼‰"
      }
    ]
  },

  "statusBar": {
    "patterns": [
      {
        "match": "Click to (.+)",
        "replace": "ç‚¹å‡»ä»¥$1"
      }
    ]
  }
}
```

---

## ğŸ”§ å·¥ä½œåŸç†

### æ¶æ„æµç¨‹

```
[æºç è‹±æ–‡æ–‡ä»¶]
    â†“
[Webpack æ„å»º]
    â†“
[LocalizationPlugin è¯»å– zh-cn.json]
    â†“
[æ„å»ºæ—¶å­—ç¬¦ä¸²æ›¿æ¢]
    â†“
[è¾“å‡ºæ±‰åŒ–åçš„ dist/ æ–‡ä»¶]
```

### å…³é”®ç»„ä»¶

1. **`scripts/injectLocalization.mts`**
   - æ³¨å…¥æ±‰åŒ–åˆ° `package.json`
   - åœ¨ `generate:contributions` åè‡ªåŠ¨è¿è¡Œ

2. **`scripts/webpack/LocalizationPlugin.mjs`**
   - Webpack æ’ä»¶ï¼Œå¤„ç†ä»£ç ä¸­çš„å­—ç¬¦ä¸²æ›¿æ¢
   - ä»…åœ¨ç”Ÿäº§æ¨¡å¼ï¼ˆ`bundle`ï¼‰å¯ç”¨

3. **`webpack.config.mjs`**
   - é›†æˆ `LocalizationPlugin`
   - Webview å’Œ Extension é…ç½®å‡å·²é›†æˆ

---

## ğŸ’¡ æœ€ä½³å®è·µ

### 1. ç²¾ç¡®åŒ¹é… vs æ­£åˆ™åŒ¹é…

**ä¼˜å…ˆä½¿ç”¨ç²¾ç¡®åŒ¹é…**ï¼ˆæ€§èƒ½æ›´å¥½ï¼‰ï¼š
```json
"exact": {
  "Welcome": "æ¬¢è¿",
  "Settings": "è®¾ç½®"
}
```

**å¤æ‚åœºæ™¯ä½¿ç”¨æ­£åˆ™**ï¼š
```json
"patterns": [
  {
    "match": "Edited (\\d+) days ago",
    "replace": "$1 å¤©å‰ç¼–è¾‘"
  }
]
```

### 2. å¢é‡æ›´æ–°ç¿»è¯‘

```bash
# åŒæ­¥ä¸Šæ¸¸å
git pull upstream main

# é‡æ–°ç”Ÿæˆ contributionsï¼ˆä¼šè‡ªåŠ¨æ³¨å…¥æ±‰åŒ–ï¼‰
pnpm run generate:contributions

# æ„å»ºç”Ÿäº§ç‰ˆæœ¬
pnpm run bundle
```

### 3. é¿å…è¿‡åº¦ç¿»è¯‘

ä»¥ä¸‹å†…å®¹**æ— éœ€ç¿»è¯‘**ï¼š
- æŠ€æœ¯æœ¯è¯­ï¼š`commit`, `branch`, `rebase`
- å“ç‰Œåç§°ï¼š`GitLens`, `GitHub`, `GitLab`
- URL å’Œè·¯å¾„

### 4. æµ‹è¯•æµç¨‹

```bash
# 1. ä¿®æ”¹ l10n/zh-cn.json
# 2. é‡æ–°ç”Ÿæˆ contributions
pnpm run generate:contributions

# 3. æ„å»ºç”Ÿäº§ç‰ˆæœ¬
pnpm run bundle

# 4. æ‰“åŒ…æµ‹è¯•
pnpm run package

# 5. å®‰è£…æµ‹è¯• .vsix æ–‡ä»¶
code --install-extension gitlens-*.vsix
```

---

## ğŸ” æ•…éšœæ’æŸ¥

### é—®é¢˜ï¼šæ„å»ºåæ²¡æœ‰çœ‹åˆ°æ±‰åŒ–

**æ£€æŸ¥æ¸…å•ï¼š**
1. âœ… æ˜¯å¦ä½¿ç”¨ `pnpm run bundle`ï¼ˆä¸æ˜¯ `build`ï¼‰
2. âœ… `l10n/zh-cn.json` æ–‡ä»¶æ˜¯å¦å­˜åœ¨ä¸”è¯­æ³•æ­£ç¡®
3. âœ… æ£€æŸ¥æ§åˆ¶å°æ˜¯å¦æœ‰é”™è¯¯è¾“å‡º

### é—®é¢˜ï¼šéƒ¨åˆ†æ–‡æœ¬æœªæ±‰åŒ–

**å¯èƒ½åŸå› ï¼š**
- æ–‡æœ¬åœ¨è¿è¡Œæ—¶åŠ¨æ€ç”Ÿæˆï¼ˆéœ€é¢å¤–å¤„ç†ï¼‰
- æ­£åˆ™è¡¨è¾¾å¼ä¸åŒ¹é…ï¼ˆæ£€æŸ¥è½¬ä¹‰å­—ç¬¦ï¼‰
- æ–‡æœ¬åœ¨ package.json ä¸­ä½†æœªæ˜ å°„

**è°ƒè¯•æ–¹æ³•ï¼š**
```bash
# å¯ç”¨è¯¦ç»†æ—¥å¿—
# ä¿®æ”¹ webpack.config.mjs ä¸­çš„ LocalizationPlugin
new LocalizationPlugin({
  verbose: true,  // æ”¹ä¸º true
})
```

### é—®é¢˜ï¼šåŒæ­¥ä¸Šæ¸¸åç¿»è¯‘ä¸¢å¤±

**è§£å†³æ–¹æ¡ˆï¼š**
```bash
# 1. å¤‡ä»½æ±‰åŒ–æ–‡ä»¶
cp l10n/zh-cn.json l10n/zh-cn.json.bak

# 2. åŒæ­¥ä¸Šæ¸¸
git pull upstream main

# 3. æ¢å¤æ±‰åŒ–æ–‡ä»¶ï¼ˆå¦‚æœè¢«è¦†ç›–ï¼‰
cp l10n/zh-cn.json.bak l10n/zh-cn.json

# 4. é‡æ–°ç”Ÿæˆ
pnpm run generate:contributions
pnpm run bundle
```

---

## ğŸ“¦ è‡ªåŠ¨åŒ–è„šæœ¬

### ä¸€é”®åŒæ­¥å¹¶æ±‰åŒ–

åˆ›å»º `scripts/sync-and-localize.sh`ï¼š

```bash
#!/bin/bash
echo "ğŸ”„ åŒæ­¥ä¸Šæ¸¸..."
git fetch upstream main
git merge upstream/main

echo "ğŸŒ é‡æ–°ç”Ÿæˆæ±‰åŒ–..."
pnpm run generate:contributions

echo "ğŸ“¦ æ„å»ºç”Ÿäº§ç‰ˆæœ¬..."
pnpm run bundle

echo "âœ… å®Œæˆï¼"
```

---

## ğŸ“ è¿›é˜¶æŠ€å·§

### æå–æœªç¿»è¯‘æ–‡æœ¬

åˆ›å»º `scripts/extractUntranslated.mjs`ï¼š

```javascript
// TODO: è‡ªåŠ¨æ‰«æä»£ç ï¼Œç”Ÿæˆå¾…ç¿»è¯‘æ–‡æœ¬æ¸…å•
```

### å¤šè¯­è¨€æ”¯æŒ

å¤åˆ¶ `zh-cn.json` â†’ `ja-jp.json`ï¼Œä¿®æ”¹ `locale` å­—æ®µå³å¯ã€‚

---

## ğŸ“§ è”ç³»ä¸åé¦ˆ

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·åœ¨ GitHub ä»“åº“æ Issueã€‚

---

**ç¥æ‚¨æ±‰åŒ–é¡ºåˆ©ï¼ğŸ‰**
